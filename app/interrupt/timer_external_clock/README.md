# 定时器外部时钟

这是一个定时器外部时钟的示例。使用对射式红外传感器接入 PA0 引脚，PA0 引脚即 TIM2 的 ETR 引脚，引脚输入一个外部时钟。

预分频器的值和实际的分频系数相差 1，即实际分频系数=预分频器的值+1，这个预分频器的值是 16 位，所以最大值可以写 65535，也就是 65536 分频。预分频器就是对输入的基准频率提前进行一个分频的操作。

计数时钟每来一个上升沿，计数器的值就加 1，计数器是 16 位，所以里面的值可以从 0 一直加到 65535.如果再加的话，计数器就会回到 0 重新开始。所以计数器的值在计时过程中会不断自增运行，当自增运行到目标值时，产生中断，那就完成了定时的任务。

自动重装载寄存器：存储目标值的寄存器。在运行的过程中，计数值不断自增，自动重装值是固定的目标，当计数值等于自动重装值时，也就是计时时间到了。那他会产生一个中断信号，并且清零计数器。计数器自动开始下一次的计数计时。

## 执行指令

```shell
cargo rp timer_external_clock
```

## 学习目标

- 了解定时器外部时钟

## 接线图

![](../../images/6-2%20定时器外部时钟.jpg)
